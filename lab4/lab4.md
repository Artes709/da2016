# Лабораторная работа 4 
## Задачи для лабораторной: 
* использование функций для автоматизации рутинных задач;
* подгонка статистической модели;

## Требования к оформлению
* Оформить решение в R Markdown. 
* Сохранить файл в свой репозиторий.
* Выгрузить R Markdown в HTML, назвать своим именем и отправить по почте (если хочется сдать раньше или нужна помощь).

## Исходные данные
&ensp;Гамма-распределения это семейство распределений вероятности, определяемых следующей
функцией плотности вероятности:   
_f(x) = (x^(a-1)⋅e^(-x/s))/(s^a)⋅Γ(a)_,   
где **гамма-функция Γ(a)** выбирается таким образом, что общая вероятность всех неотрицательных _x_ равняется 1.
Параметр _a_ называется форма, параметр s масштаб.
В R существует стандартная функция для получения плотности вероятности: ``dgamma()``.  
&ensp;В лабораторной работе следует удостовериться, что математическое ожидание этого распределния
равняется _as_, а дисперсия _as^2_.  
Если мат. ожидание (μ) и дисперсия (σ²) известны, тогда параметры будут равны:  
   _a = μ²/σ²_,  
   _s =  σ²/μ_  

&ensp;В лабораторной необходимо выполнить подгонку гамма-распределения под данные и оценить результаты подгонки.
Данными для анализа будут встроенный в R набор данных о весе тел и сердец котов и кошек.
### Задание
1. Загрузите датафрейм _cats_ (посмотреть описание датафрейма можно при помощи команды ``help(cats)``) из пакета _MASS_, при помощи команд:
```
library(MASS)
data(cats)
```
Выполните команду ``summary(cats)`` и опишите результат.
2. Рассчитайте среднее (mean), среднеквадратичное отклонение (sd) и дисперсию (var) веса кошачьих сердец.
3. При помощи полученных занчений и формул выше, рассчитайте параметры _a_ и _s_.
Округлите до разумного числа знаков.
4. Напишите функцию для расчёта парметров _a_ и _s_ через дисперсию и среднее для передаваемого вектора чисел.
Функция должна зазываться _my.gamma_ и возвращать рассчитанные параметры в виде именнованного вектора.
5. Какие результаты возвращает функция для вектора весов сердец? Сходятся ли они с ответами в п. 3? Должны сходиться?
6. Постройте гистограмму весов. Добавьте на гистограмму кривую плотности вероятности при помощи функций
``curve`` и ``dgamma``, указав ранее найденные параметры формы и масштаба.
7. Получите параметры _a_ и _s_ отдельно для котов и кошек, использовав функцию _my.gamma_.
8. Посторойте полученные функции распределения на одном графике, используя ``curve`` и ``dgamma``.
9. Случайным образом разделите данные на две группы одного размера равного количеству котов и кошек соответственно.
Получите гамма-параметры для обеих групп. Повторите эксперимент несколько раз.
Найдите среднюю разницу между результатами групп.
10. Какие выводы можно сделать относительно полученных распределений для кошек и котов. Есть ли разница? Поясните.

TBD....